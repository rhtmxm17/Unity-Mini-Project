# 유니티 미니게임 설계

핵심 목표: 3D모델과 애니메이션을 사용해 쿼터뷰 전투 구현

3d, 내비메시, 방향키 이동, 마우스 조준
URP-> 필요하다면 스텐실 정도만 사용(플레이어 가리는 물체 반투명하게)

## 프로토타입 베이스

개발한 기능을 보여줄 수 있는 기반

* 플레이어
  * 이동
  * 기본공격
  * 기본 애니메이션(대기, 이동, 공격)
* 표적
  * 피격 확인
* 카메라

## 컨텐츠

* 플레이어
  * 3종의 공격방식
  * 강화
  * 피격
  * 회복
* 몬스터
  * 2종의 일반 몬스터와 1종의 보스 몬스터
  * 행동패턴
    * 추적
    * 공격방법 선택
  * 드랍
* 방
  * 3종의 방 형태
  * 방마다 2종의 몬스터 스폰 패턴
* 게임
  * 일시정지
  * 스킬(강화 상태) 확인

## 설계

* 플레이어  
  피격, 아이템 습득과 같은 충돌 정보는 어디서 관리할지 고려
  * 모델  
    값과 트리거를 전달하는 매개로 사용할것
  * 컨트롤러  
    입력을 받아서 NavMeshAgent 이동 명령, 스킬에 공격 명령 및 모델에 전달
  * 모델의 눈깜빡임, 바람, 스프링 동작은 애셋 사용(`UnityChan.AutoBlinkforSD`, `UnityChan.RandomWind`, `UnityChan.SpringManager`)  
    입장 컷신같이 확대될 때에만 켜는게 좋을듯
  * 공격(스킬)
    스킬 시전 입력시 모션진입 일정 시간 후 시전으로 이어져야 하므로 스킬마다 애니메이션, 준비시간, 내용(투사체 등)으로 구성될 필요
  * 상태
    상태에 따라 InputAction들에 메서드들을 할당/해제
* 카메라  
  포인터 위치와 플레이어 사이를 바라보게 하기  
  스테이지 입장시 Timeline 활용해 컷신 넣자
* 스테이지  
  미리 준비된 방 패턴(ScriptableObject?)중 n개를 이어붙이고 마지막에 보스룸 붙이기
  * 방
* 몬스터  
  적어도 휴머노이드 타입은 ScriptableObject로 만들자
  * 원거리 공격 타입 기본 행동 패턴  
    1. 플레이어 추적(NavMeshAgent)
    1. 사선(射線) 검사
    1. 공격  
    공격 대기 시간동안 선회?

## 우선순위

1. 프로토타입 베이스
1. 몬스터(투사체 발사 몬스터 1종, 공격과 행동패턴)
1. 샘플 스테이지
1. 방 기능(몬스터 소환, 클리어 확인) 구현
1. 스킬 종류 확장
1. 몬스터 종류 확장
1. 보스 몬스터
1. 스크립터블 방 구현
1. 스테이지(랜덤 방 + 보스 룸 조합) 구현
1. 최적화 요소(공유 데이터 스크립터블로)
1. 애니메이션 디테일

## 리팩터링을 통한 개선 여지

* 플레이어 컨트롤러와 몬스터 컨트롤을 캐릭터 컨트롤이라는 공통분모를 추출해서 사용하면 확장성을 넓힐 수 있지 않을까?
  몬스터와 플레이어의 구분 없이 스킬을 올려만 두면 쓸 수 있을듯 함. 캐릭터를 움직이는 것이 행동 규칙인지 플레이어의 입력인지만 달라지는 것.
